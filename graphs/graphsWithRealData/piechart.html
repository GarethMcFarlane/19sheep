<head>
<script src="http://code.jquery.com/jquery-1.6.3.min.js"></script>
<script src="highcharts.js"></script>
<script src="exporting.js"></script>
<title>Graphs</title>
</head>

<body>
<div id="container" style="min-width: 400px; height: 400px; margin: 0 auto"></div>
<!--<input type="button" id="btnPieChart" value="Pie Chart" />--> 
<script>$(document).ready(function () {    
            var json = {"status":0,"body":{"model":16,"series":[{"startdate":1441285440,"state":2,"enddate":1441286700},{"startdate":1441286700,"state":1,"enddate":1441288020},{"startdate":1441288020,"state":2,"enddate":1441291680},{"startdate":1441291680,"state":1,"enddate":1441293060},{"startdate":1441293060,"state":2,"enddate":1441295160},{"startdate":1441295160,"state":1,"enddate":1441295460},{"startdate":1441295460,"state":0,"enddate":1441296000},{"startdate":1441296000,"state":1,"enddate":1441297920},{"startdate":1441297920,"state":2,"enddate":1441299960},{"startdate":1441299960,"state":1,"enddate":1441302840},{"startdate":1441302840,"state":2,"enddate":1441304640},{"startdate":1441304640,"state":1,"enddate":1441306921}]}};

            var l= json.body.series;
            var lightSleep=0;
            var deepSleep=0;
            var awake=0;



            for(i=0;i<l.length;++i){
              if(l[i].state==0){
                awake+= l[i].enddate-l[i].startdate;
              }
              if(l[i].state==1){
                lightSleep+=l[i].enddate-l[i].startdate;;
              }
              if(l[i].state==2){
                deepSleep+=l[i].enddate-l[i].startdate;;
              }

            }           
            RenderPieChart('container', [
                      ['Awake', awake],
                      ['LightSleep', lightSleep],
                      ['DeepSleep', deepSleep]
                  ]);     
     
     /*$('#btnPieChart').live('click', function(){ 
         var data = [
                      ['Firefox', 42.0],
                      ['IE', 26.8],
                      {
                          name: 'Chrome',
                          y: 14.8,
                          sliced: true,
                          selected: true
                      },
                      ['Safari', 6.5],
                      ['Opera', 8.2],
                      ['Others', 0.7]
                  ];
             
            RenderPieChart('container', data);
     });*/
     
            function RenderPieChart(elementId, dataList) {
                new Highcharts.Chart({
                    chart: {
                        renderTo: elementId,
                        plotBackgroundColor: null,
                        plotBorderWidth: null,
                        plotShadow: false
                    }, title: {
                        text: 'Sleep data'
                    },
                    tooltip: {
                        formatter: function () {
                            return '<b>' + this.point.name + '</b>: ' +  Math.floor(this.point.y/3600) + "hrs " + Math.floor((this.point.y - Math.floor(this.point.y/3600)*3600)/60) + "mins " + Math.round((((this.point.y - Math.floor(this.point.y/3600)*3600)/60 - Math.floor((this.point.y - Math.floor(this.point.y/3600)*3600)/60))*60)*10)/10+"secs";

                            //this.point.y-Math.floor(this.point.y/3600)*3600-Math.floor((this.point.y - Math.floor(this.point.y/3600)*3600)/60)*60
                        }
                    },
                    plotOptions: {
                        pie: {
                            allowPointSelect: true,
                            cursor: 'pointer',
                            dataLabels: {
                                enabled: true,
                                color: '#000000',
                                connectorColor: '#000000',
                                formatter: function () {
                                    return '<b>' + this.point.name + '</b>: ' + Math.round(this.percentage*10)/10 + ' %';
                                }
                            }
                        }
                    },
                    series: [{
                        type: 'pie',
                        name: 'Browser share',
                        data: dataList
                    }]
                });
            };
        });</script>
</body>
</html>